# ğŸš€ Polygon L2 MVP éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

**ç›®æ ‡**: åœ¨ä¸€å°äº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½² Polygon L2 çš„ MVP ç‰ˆæœ¬

**ä¸ç”Ÿäº§ç¯å¢ƒçš„åŒºåˆ«**:
- âœ… æ‰€æœ‰æœåŠ¡è¿è¡Œåœ¨**ä¸€å°æœåŠ¡å™¨**ä¸Š
- âœ… ä½¿ç”¨**è½»é‡çº§é…ç½®**
- âœ… Prover ä½¿ç”¨**æœ€å°é…ç½®**ï¼ˆ8æ ¸ 32GBï¼‰
- âœ… é€‚åˆ**æµ‹è¯•å’Œæ¼”ç¤º**
- âŒ ä¸é€‚åˆé«˜å¹¶å‘ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ’» æœåŠ¡å™¨è¦æ±‚

### å•å°æœåŠ¡å™¨é…ç½®

```
CPU:     16 æ ¸ï¼ˆæ¨èï¼‰æˆ– 8 æ ¸ï¼ˆæœ€ä½ï¼‰
å†…å­˜:    64 GBï¼ˆæ¨èï¼‰æˆ– 32 GBï¼ˆæœ€ä½ï¼‰
ç¡¬ç›˜:    500 GB SSD
å¸¦å®½:    100 Mbps
ç³»ç»Ÿ:    Ubuntu 22.04 LTS
```

**äº‘æœåŠ¡å™¨æ¨è**:
- AWS: `c6i.4xlarge` (16æ ¸ 32GB) - çº¦ $500/æœˆ
- é˜¿é‡Œäº‘: `ecs.c7.4xlarge` (16æ ¸ 32GB) - çº¦ Â¥2,500/æœˆ
- è…¾è®¯äº‘: `S5.4XLARGE32` (16æ ¸ 32GB) - çº¦ Â¥2,000/æœˆ

**æœ€ä½é…ç½®**ï¼ˆä»…æµ‹è¯•ï¼‰:
- AWS: `c6i.2xlarge` (8æ ¸ 16GB) - çº¦ $250/æœˆ
- é˜¿é‡Œäº‘: `ecs.c7.2xlarge` (8æ ¸ 16GB) - çº¦ Â¥1,200/æœˆ

---

## ğŸ¯ æ ¸å¿ƒå˜åŒ–ï¼ˆMVP vs ç”Ÿäº§ï¼‰

| ç»„ä»¶ | ç”Ÿäº§ç¯å¢ƒ | MVP ç‰ˆæœ¬ |
|------|---------|---------|
| **æœåŠ¡å™¨æ•°é‡** | 5 å° | **1 å°** |
| **Prover é…ç½®** | 32æ ¸ 256GB | **8æ ¸ 32GB** |
| **æ€»æˆæœ¬** | $3,000-6,750/æœˆ | **$250-500/æœˆ** |
| **TPS** | 1000+ | **10-50** |
| **é€‚ç”¨åœºæ™¯** | ç”Ÿäº§ç¯å¢ƒ | **æµ‹è¯•/æ¼”ç¤º** |

---

## ğŸ“¦ éƒ¨ç½²æ­¥éª¤

### Step 1: å‡†å¤‡æœåŠ¡å™¨ï¼ˆ30 åˆ†é’Ÿï¼‰

```bash
# 1. è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@YOUR_SERVER_IP

# 2. æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# 3. å®‰è£… Docker
curl -fsSL https://get.docker.com | sh
systemctl start docker
systemctl enable docker

# 4. å®‰è£… Docker Compose
apt install -y docker-compose-plugin

# 5. å®‰è£…å…¶ä»–ä¾èµ–
apt install -y git curl jq

# 6. éªŒè¯å®‰è£…
docker --version
docker compose version
```

### Step 2: å…‹éš†é…ç½®æ–‡ä»¶ï¼ˆ5 åˆ†é’Ÿï¼‰

```bash
# 1. åˆ›å»ºå·¥ä½œç›®å½•
mkdir -p /opt/polygon-l2-mvp
cd /opt/polygon-l2-mvp

# 2. ä»ä½ çš„ safe-space å¤åˆ¶é…ç½®
# (å‡è®¾ä½ å·²ç»æŠŠæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨)
```

### Step 3: é…ç½®ç¯å¢ƒå˜é‡ï¼ˆ10 åˆ†é’Ÿï¼‰

```bash
# åˆ›å»º .env æ–‡ä»¶
cat > .env << 'EOF'
# L1 é…ç½® (atoshi-chain)
L1_RPC_URL=http://YOUR_ATOSHI_CHAIN_RPC:8545
L1_CHAIN_ID=12345

# L2 é…ç½®
L2_CHAIN_ID=67890

# è´¦æˆ·é…ç½®
DEPLOYER_PRIVATE_KEY=0x...
SEQUENCER_PRIVATE_KEY=0x...
AGGREGATOR_PRIVATE_KEY=0x...

# æ•°æ®åº“é…ç½®
POSTGRES_USER=zkevmuser
POSTGRES_PASSWORD=zkevmpassword
POSTGRES_DB=zkevmdb

# Prover é…ç½® (MVP è½»é‡çº§)
PROVER_THREADS=4
PROVER_MEMORY=16G
EOF

# åŠ è½½ç¯å¢ƒå˜é‡
source .env
```

### Step 4: å¯åŠ¨æœåŠ¡ï¼ˆ10 åˆ†é’Ÿï¼‰

```bash
# 1. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d

# 2. æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# 3. ç­‰å¾…æœåŠ¡å¯åŠ¨ï¼ˆçº¦ 2-3 åˆ†é’Ÿï¼‰
```

### Step 5: éªŒè¯éƒ¨ç½²ï¼ˆ5 åˆ†é’Ÿï¼‰

```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker compose ps

# 2. æµ‹è¯• RPC
curl -X POST http://localhost:8545 \
  -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}'

# 3. æŸ¥çœ‹åŒºå—é«˜åº¦
cast block-number --rpc-url http://localhost:8545
```

---

## ğŸ”§ MVP é…ç½®æ–‡ä»¶

### docker-compose.yml (è½»é‡çº§ç‰ˆæœ¬)

æ‰€æœ‰æœåŠ¡è¿è¡Œåœ¨ä¸€å°æœºå™¨ä¸Šï¼Œä½¿ç”¨æœ€å°èµ„æºé…ç½®ã€‚

**å…³é”®ä¼˜åŒ–**:
- Prover åªåˆ†é… 8 æ ¸ 16GBï¼ˆè€Œä¸æ˜¯ 32 æ ¸ 256GBï¼‰
- æ‰€æœ‰æœåŠ¡å…±äº«ç½‘ç»œ
- ä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼ˆè€Œä¸æ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼‰
- å‡å°‘å‰¯æœ¬æ•°é‡

### node-config.toml (MVP é…ç½®)

**å…³é”®è°ƒæ•´**:
```toml
[Sequencer.Finalizer]
    MaxTxsPerBatch = 50              # å‡å°‘æ‰¹æ¬¡å¤§å°
    ResourcePercentageToCloseBatch = 50  # æ›´å¿«å…³é—­æ‰¹æ¬¡

[Aggregator]
    VerifyProofInterval = "60s"      # é™ä½éªŒè¯é¢‘ç‡
    
[Prover]
    MaxProvers = 2                   # å‡å°‘ Prover æ•°é‡
```

---

## ğŸ“Š æ€§èƒ½é¢„æœŸ

### MVP ç‰ˆæœ¬æ€§èƒ½

| æŒ‡æ ‡ | MVP ç‰ˆæœ¬ | ç”Ÿäº§ç‰ˆæœ¬ |
|------|---------|---------|
| **TPS** | 10-50 | 1000+ |
| **åŒºå—æ—¶é—´** | 10-30 ç§’ | 2-5 ç§’ |
| **è¯æ˜ç”Ÿæˆ** | 2-5 åˆ†é’Ÿ | 30-60 ç§’ |
| **Gas æˆæœ¬** | ä¸ç”Ÿäº§ç›¸åŒ | ä¸ç”Ÿäº§ç›¸åŒ |

**é€‚ç”¨åœºæ™¯**:
- âœ… åŠŸèƒ½æµ‹è¯•
- âœ… æ¼”ç¤º Demo
- âœ… å¼€å‘è°ƒè¯•
- âŒ é«˜å¹¶å‘ç”Ÿäº§

---

## ğŸ’° æˆæœ¬å¯¹æ¯”

### å•å°æœåŠ¡å™¨ MVP

```
æœåŠ¡å™¨:        $250-500/æœˆ (16æ ¸ 64GB)
å­˜å‚¨:          åŒ…å«åœ¨æœåŠ¡å™¨ä¸­
å¸¦å®½:          åŒ…å«åœ¨æœåŠ¡å™¨ä¸­
ç›‘æ§:          $0 (ä½¿ç”¨å…è´¹å·¥å…·)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:          $250-500/æœˆ
```

### ç”Ÿäº§ç¯å¢ƒï¼ˆå¯¹æ¯”ï¼‰

```
Sequencer:     $200-300/æœˆ
Aggregator:    $100-150/æœˆ
Prover:        $2,000-5,000/æœˆ  â† æœ€è´µ
RPC:           $400-600/æœˆ
Database:      $300-500/æœˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:          $3,000-6,750/æœˆ
```

**èŠ‚çœ**: çº¦ **85-90%** æˆæœ¬

---

## âš ï¸ MVP é™åˆ¶

### æ€§èƒ½é™åˆ¶

1. **TPS è¾ƒä½**
   - MVP: 10-50 TPS
   - ç”Ÿäº§: 1000+ TPS

2. **è¯æ˜ç”Ÿæˆæ…¢**
   - MVP: 2-5 åˆ†é’Ÿ
   - ç”Ÿäº§: 30-60 ç§’

3. **ä¸é€‚åˆé«˜å¹¶å‘**
   - å•å°æœåŠ¡å™¨èµ„æºæœ‰é™
   - æ— æ³•æ°´å¹³æ‰©å±•

### å¯é æ€§é™åˆ¶

1. **å•ç‚¹æ•…éšœ**
   - æœåŠ¡å™¨å®•æœº = æ•´ä¸ªç³»ç»Ÿå®•æœº
   - ç”Ÿäº§ç¯å¢ƒæœ‰å¤šä¸ªå‰¯æœ¬

2. **æ— é«˜å¯ç”¨**
   - æ²¡æœ‰æ•…éšœè½¬ç§»
   - æ²¡æœ‰è´Ÿè½½å‡è¡¡

3. **å­˜å‚¨é™åˆ¶**
   - æœ¬åœ°å­˜å‚¨ï¼Œæ— å¤‡ä»½
   - æ•°æ®ä¸¢å¤±é£é™©

### ä½•æ—¶å‡çº§åˆ°ç”Ÿäº§

å½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œè€ƒè™‘å‡çº§ï¼š

- [ ] æ—¥äº¤æ˜“é‡ > 1,000 ç¬”
- [ ] ç”¨æˆ·æ•° > 100
- [ ] éœ€è¦ 99.9% å¯ç”¨æ€§
- [ ] éœ€è¦æ›´å¿«çš„è¯æ˜ç”Ÿæˆ
- [ ] æœ‰ä¸“é—¨çš„è¿ç»´å›¢é˜Ÿ

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆä¸€é”®è„šæœ¬ï¼‰

### è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

```bash
#!/bin/bash
# deploy-mvp.sh - ä¸€é”®éƒ¨ç½² Polygon L2 MVP

set -e

echo "ğŸš€ å¼€å§‹éƒ¨ç½² Polygon L2 MVP..."

# 1. æ£€æŸ¥ç¯å¢ƒ
echo "ğŸ“‹ æ£€æŸ¥ç¯å¢ƒ..."
command -v docker >/dev/null 2>&1 || { echo "âŒ Docker æœªå®‰è£…"; exit 1; }
command -v docker compose >/dev/null 2>&1 || { echo "âŒ Docker Compose æœªå®‰è£…"; exit 1; }

# 2. åˆ›å»ºç›®å½•
echo "ğŸ“ åˆ›å»ºç›®å½•..."
mkdir -p data/{statedb,pooldb,prover}
mkdir -p config

# 3. å¯åŠ¨æœåŠ¡
echo "ğŸ³ å¯åŠ¨ Docker æœåŠ¡..."
docker compose up -d

# 4. ç­‰å¾…æœåŠ¡å°±ç»ª
echo "â³ ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 30

# 5. éªŒè¯éƒ¨ç½²
echo "âœ… éªŒè¯éƒ¨ç½²..."
curl -s -X POST http://localhost:8545 \
  -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' \
  | jq .

echo "ğŸ‰ éƒ¨ç½²å®Œæˆï¼"
echo ""
echo "ğŸ“ æœåŠ¡ç«¯ç‚¹:"
echo "  - RPC: http://localhost:8545"
echo "  - WebSocket: ws://localhost:8546"
echo ""
echo "ğŸ“‹ æŸ¥çœ‹æ—¥å¿—:"
echo "  docker compose logs -f"
```

ä½¿ç”¨æ–¹æ³•:
```bash
chmod +x deploy-mvp.sh
./deploy-mvp.sh
```

---

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰

- [ ] å‡†å¤‡ä¸€å° 16æ ¸ 64GB æœåŠ¡å™¨ï¼ˆæˆ– 8æ ¸ 32GB æœ€ä½ï¼‰
- [ ] å®‰è£… Docker å’Œ Docker Compose
- [ ] å‡†å¤‡ atoshi-chain RPC URL
- [ ] å‡†å¤‡éƒ¨ç½²è´¦æˆ·ç§é’¥
- [ ] å‡†å¤‡ Sequencer å’Œ Aggregator è´¦æˆ·

### éƒ¨ç½²ä¸­

- [ ] é…ç½® .env æ–‡ä»¶
- [ ] å¯åŠ¨ Docker æœåŠ¡
- [ ] ç­‰å¾…æœåŠ¡å°±ç»ª
- [ ] éªŒè¯ RPC å¯è®¿é—®

### éƒ¨ç½²å

- [ ] æµ‹è¯•åŒºå—ç”Ÿæˆ
- [ ] æµ‹è¯•äº¤æ˜“æäº¤
- [ ] ç›‘æ§èµ„æºä½¿ç”¨
- [ ] é…ç½®æ—¥å¿—æ”¶é›†

---

## ğŸ” ç›‘æ§å’Œç»´æŠ¤

### èµ„æºç›‘æ§

```bash
# æŸ¥çœ‹ CPU å’Œå†…å­˜ä½¿ç”¨
docker stats

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥çœ‹æ—¥å¿—å¤§å°
du -sh data/
```

### æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs -f zkevm-sequencer

# æ¸…ç†æ—§æ—¥å¿—
docker compose logs --tail=1000 > logs.txt
```

### å¸¸è§é—®é¢˜

**Q1: Prover å†…å­˜ä¸è¶³**
```bash
# å‡å°‘ Prover çº¿ç¨‹æ•°
# ç¼–è¾‘ docker-compose.yml
environment:
  - PROVER_THREADS=2  # ä» 4 æ”¹ä¸º 2
```

**Q2: ç£ç›˜ç©ºé—´ä¸è¶³**
```bash
# æ¸…ç† Docker ç¼“å­˜
docker system prune -a

# æ¸…ç†æ—§æ•°æ®
rm -rf data/statedb/pg_wal/*
```

**Q3: æœåŠ¡å¯åŠ¨å¤±è´¥**
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker compose logs zkevm-prover

# é‡å¯æœåŠ¡
docker compose restart zkevm-prover
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### å®Œæˆ MVP éƒ¨ç½²å

1. **éƒ¨ç½²éšç§åˆçº¦**
   ```bash
   cd /path/to/atoshi-privacy-contracts
   npx hardhat run scripts/deploy.js --network mvpL2
   ```

2. **æ›´æ–° SDK é…ç½®**
   ```typescript
   const config = {
     l2RpcUrl: 'http://YOUR_SERVER_IP:8545',
     shieldContract: '0x...',
   };
   ```

3. **æµ‹è¯•éšç§äº¤æ˜“**
   ```bash
   npm run test:e2e
   ```

### å‡çº§åˆ°ç”Ÿäº§ç¯å¢ƒ

å½“ MVP éªŒè¯æˆåŠŸåï¼Œå¯ä»¥æŒ‰ç…§ `POLYGON_L2_MIGRATION_PLAN.md` å‡çº§åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

---

## ğŸ“ è·å–å¸®åŠ©

- **MVP é—®é¢˜**: æŸ¥çœ‹æœ¬æ–‡æ¡£çš„"å¸¸è§é—®é¢˜"éƒ¨åˆ†
- **ç”Ÿäº§éƒ¨ç½²**: å‚è€ƒ `POLYGON_L2_MIGRATION_PLAN.md`
- **Polygon æ”¯æŒ**: https://discord.gg/polygon

---

## âœ… æˆåŠŸæ ‡å¿—

MVP éƒ¨ç½²æˆåŠŸçš„æ ‡å¿—ï¼š

- [ ] æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
- [ ] Docker æœåŠ¡å…¨éƒ¨å¯åŠ¨
- [ ] RPC å¯ä»¥è®¿é—®
- [ ] å¯ä»¥æŸ¥è¯¢åŒºå—é«˜åº¦
- [ ] å¯ä»¥æäº¤äº¤æ˜“
- [ ] éšç§åˆçº¦éƒ¨ç½²æˆåŠŸ
- [ ] å¯ä»¥è¿›è¡Œéšç§äº¤æ˜“

**æ­å–œï¼ä½ çš„ MVP å·²ç»æˆåŠŸéƒ¨ç½²ï¼** ğŸ‰

